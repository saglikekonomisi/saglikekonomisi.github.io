<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ä°slami Hukuki Hesaplamalar PortalÄ±</title>
<style>
  :root {
    --bg:#f4f7fb; --card:#fff; --accent:#8b1c1c; --primary:#00796b; --muted:#556;
    --warn-bg:#fff5f5; --warn-border:#c53030;
  }
  body { font-family: 'Inter', sans-serif; margin:0; background:var(--bg); color:#222; line-height:1.6; }
  header { background: linear-gradient(135deg, var(--primary), #26a69a); color:#fff; padding:30px 20px; text-align:center; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
  .wrap { max-width:1150px; margin:20px auto; padding:0 20px; }
  
  .tabs { display:flex; gap:5px; border-bottom:2px solid #ddd; margin-bottom:20px; overflow-x:auto; }
  .tab-btn { padding:12px 25px; border:none; background:#e0e0e0; cursor:pointer; font-weight:700; border-radius:8px 8px 0 0; white-space:nowrap; }
  .tab-btn.active { background:var(--primary); color:#fff; }
  .tab-content { display:none; animation: fadeIn 0.3s; }
  .tab-content.active { display:block; }

  .grid { display:grid; grid-template-columns: 1fr 420px; gap:20px; align-items:start; }
  .card { background:var(--card); padding:20px; border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,0.05); margin-bottom:20px; }
  h2 { font-size:20px; margin-top:0; color:var(--primary); border-bottom:1px solid #eee; padding-bottom:10px; }
  
  label { display:block; font-weight:700; margin:10px 0 5px; font-size:13px; }
  input, select { width:100%; padding:10px; border-radius:8px; border:1px solid #ddd; box-sizing:border-box; font-size:14px; }
  .row { display:flex; gap:10px; }
  .col { flex:1; }
  
  button { background:var(--primary); color:#fff; border:0; padding:12px; border-radius:8px; cursor:pointer; font-weight:700; width:100%; font-size:15px; transition:0.2s; }
  button:hover { opacity:0.9; }
  button.feraiz-btn { background:var(--accent); }

  .gold-info { background: #fff9c4; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 13px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #fbc02d; }
  .heir { background:#f9f9f9; padding:12px; border-radius:8px; margin-bottom:10px; border-left:4px solid var(--accent); }
  .pct { font-weight:800; font-size:20px; color:var(--accent); }
  pre { background:#0b1220; color:#cfe8ff; padding:12px; border-radius:6px; font-size:12px; overflow:auto; max-height:200px; white-space: pre-wrap; }
  
  .verse-box { background:#eef2f7; border-left:4px solid var(--primary); padding:15px; margin:20px 0; border-radius:0 8px 8px 0; font-style:italic; font-size:14px; }
  .verse-box b { color:var(--primary); display:block; margin-bottom:5px; font-style:normal; }
  .official-warning { background:var(--warn-bg); border:2px solid var(--warn-border); color:var(--warn-border); padding:15px; border-radius:10px; text-align:center; font-weight:800; margin-top:20px; }

  @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
  @media(max-width:900px) { .grid { grid-template-columns: 1fr; } }
</style>
</head>
<body onload="fetchGoldPrice()">

<header>
  <h1>âš–ï¸ Ä°slami Hukuki Hesaplamalar PortalÄ±</h1>
  <div style="opacity:0.9">ZekÃ¢t, Diyet, Ä°ddet ve GeliÅŸmiÅŸ Feraiz (Miras) Sistemi</div>
</header>

<div class="wrap">
  <div class="gold-info">
    <span>ğŸ’° <b>GÃ¼ncel Gram AltÄ±n (24 Ayar):</b> <span id="current_gold_text">YÃ¼kleniyor...</span></span>
    <button onclick="fetchGoldPrice()" style="width: auto; padding: 5px 10px; font-size: 11px; margin: 0;">FiyatÄ± GÃ¼ncelle</button>
  </div>

  <div class="tabs">
    <button class="tab-btn active" onclick="openTab(event, 'Zekat')">ZEKÃ‚T</button>
    <button class="tab-btn" onclick="openTab(event, 'Feraiz')">FERAÄ°Z (MÄ°RAS)</button>
    <button class="tab-btn" onclick="openTab(event, 'Diyet')">DÄ°YET</button>
    <button class="tab-btn" onclick="openTab(event, 'Iddet')">Ä°DDET</button>
  </div>

 <div id="Zekat" class="tab-content active">
  <div class="card" style="max-width:800px; margin:auto;">
    <h2>ğŸ’° ZekÃ¢t Hesaplama ve Rehber</h2>
    <div class="row">
      <div class="col">
        <label>Åahsi AltÄ±n/TakÄ± (Gram):</label> 
        <input type="number" id="z_altin" value="0">
        <label>Eldeki Nakit ve DÃ¶viz (TL):</label> 
        <input type="number" id="z_nakit" value="0">
      </div>
      <div class="col">
        <label>Ticari Mal/Stok DeÄŸeri (TL):</label> 
        <input type="number" id="z_ticari" value="0">
        <label>GÃ¼ncel Gram AltÄ±n FiyatÄ± (TL):</label> 
        <input type="number" id="z_fiyat" value="7000" oninput="updateDevePrice()">
      </div>
    </div>
    <button onclick="calcZekat()">ZekÃ¢tÄ± Hesapla</button>
    <div id="z_res" style="margin-top:15px; display:none;" class="heir"></div>
    <div style="margin-top: 25px; background: #fdfdfd; border: 1px solid #e0e0e0; padding: 20px; border-radius: 12px; font-size: 13.5px;">
      <h3 style="margin-top:0; color:var(--primary); font-size: 16px;">ğŸ” Zekat HakkÄ±nda Temel Bilgiler</h3>
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
        <div>
          <b>ğŸ“Œ Nisab MiktarÄ± Nedir?</b>
          <p>ZekÃ¢t vermekle yÃ¼kÃ¼mlÃ¼ olmak iÃ§in temel ihtiyaÃ§lar ve borÃ§lar dÄ±ÅŸÄ±nda <b>80.18 gram altÄ±n</b> veya bu deÄŸerde mala sahip olmak gerekir. Bu malÄ±n Ã¼zerinden 1 kameri yÄ±l geÃ§miÅŸ olmalÄ±dÄ±r.</p>
        </div>
        <div>
          <b>ğŸ“ˆ Zekat OranlarÄ±</b>
          <ul style="padding-left: 15px; margin: 5px 0;">
            <li>Nakit, AltÄ±n, Ticari Mal: <b>%2.5 (1/40)</b></li>
            <li>Toprak ÃœrÃ¼nleri (Ã–ÅŸÃ¼r): <b>%10 veya %5</b></li>
            <li>BÃ¼yÃ¼kbaÅŸ Hayvan: <b>30'da 1</b></li>
          </ul>
        </div>
      </div>
      <h3 style="margin: 15px 0 5px 0; color:var(--primary); font-size: 15px;">ğŸ‘¥ ZekÃ¢t Kimlere Verilir? (Tevbe, 60)</h3>
      <p style="margin-bottom: 10px;">ZekÃ¢tÄ±n verilebileceÄŸi 8 sÄ±nÄ±f ayetle belirlenmiÅŸtir: Fakirler, miskinler (hiÃ§bir ÅŸeyi olmayanlar), borÃ§lular, yolda kalmÄ±ÅŸlar, Allah yolunda olanlar, kalbi Ä°slam'a Ä±sÄ±ndÄ±rÄ±lacak olanlar, kÃ¶lelikten kurtulacak olanlar ve zekat memurlarÄ±.</p>
      <div style="background: #fffbe6; border-left: 4px solid #ffe58f; padding: 10px; font-weight: bold;">
        âŒ Kimlere Verilmez?
        <p style="font-weight: normal; font-size: 12px; margin: 5px 0 0 0;">Anne, baba, bÃ¼yÃ¼kanne, bÃ¼yÃ¼kbaba, Ã§ocuklar ve torunlara (usul ve fÃ¼ru) ile eÅŸe zekÃ¢t verilmez. Ã‡Ã¼nkÃ¼ kiÅŸi bunlara bakmakla zaten yÃ¼kÃ¼mlÃ¼dÃ¼r.</p>
      </div>
      <div style="background: #fff; border: 1px dashed #ccc; padding: 12px; margin-top: 15px;">
        <p><b>ğŸ“– Ayet-i Kerime:</b> "NamazÄ± kÄ±lÄ±n, zekÃ¢tÄ± verin. Ã–nceden kendiniz iÃ§in ne hayÄ±r yaparsanÄ±z, Allah katÄ±nda onu bulursunuz..." (Bakara, 110)</p>
      </div>
    </div>
    <div class="official-warning">
      âš ï¸ Ã–NEMLÄ°: Hisse senedi, kira geliri ve ÅŸirket ortaklÄ±klarÄ± gibi karmaÅŸÄ±k varlÄ±klarÄ±n zekatÄ± iÃ§in Diyanet Alo 190 Fetva HattÄ±'na danÄ±ÅŸmanÄ±z tavsiye edilir.
    </div>
  </div>
</div>

  <div id="Feraiz" class="tab-content">
    <div class="grid">
      <div class="card">
        <h2>ğŸ“œ MirasÃ§Ä± Bilgileri (GeliÅŸmiÅŸ)</h2>
        <div class="row">
          <div class="col"><label>Ã–len</label><select id="f_gender"><option value="male">Erkek</option><option value="female">KadÄ±n</option></select></div>
          <div class="col"><label>EÅŸ SayÄ±sÄ±</label><input id="f_spouses" type="number" value="0"></div>
        </div>
        <div class="row">
          <div class="col"><label>OÄŸul</label><input id="f_sons" type="number" value="0"></div>
          <div class="col"><label>KÄ±z</label><input id="f_daughters" type="number" value="0"></div>
        </div>
        <div class="row">
          <div class="col"><label>Erkek Torun</label><input id="f_grsons" type="number" value="0"></div>
          <div class="col"><label>KÄ±z Torun</label><input id="f_grdau" type="number" value="0"></div>
        </div>
        <div style="margin:10px 0; font-size:12px;"><input id="f_replace" type="checkbox"> <label for="f_replace">Ã‡ocuk yoksa torunlar temsil etsin</label></div>
        <div class="row">
          <div class="col"><label>Anne</label><select id="f_mother"><option value="yes">Evet</option><option value="no">HayÄ±r</option></select></div>
          <div class="col"><label>Baba</label><select id="f_father"><option value="yes">Evet</option><option value="no">HayÄ±r</option></select></div>
        </div>
        <div class="row">
          <div class="col"><label>Erkek KardeÅŸ</label><input id="f_bro" type="number" value="0"></div>
          <div class="col"><label>KÄ±z KardeÅŸ</label><input id="f_sis" type="number" value="0"></div>
        </div>
        <button class="feraiz-btn" onclick="calcFeraiz()">HESAPLA</button>
        <div class="verse-box"><b>ğŸ“– Ayet:</b> "Allah size Ã§ocuklarÄ±nÄ±zÄ±n mirasÄ± hakkÄ±nda erkeÄŸe iki, kadÄ±na bir pay tavsiye eder..." (NisÃ¢, 11)</div>
        <div class="official-warning">âš ï¸ FERAÄ°Z HESABI UZMANLIK GEREKTÄ°RÄ°R. BURADA YAZMAYAN YEÄEN, KUZEN VE DAHA DETAYLI AKRABALIKLARIN DA TEK TEK DÄ°KKATE ALINMASI GEREKEBÄ°LÄ°R. MÃœFTÃœLÃœÄE BAÅVURUNUZ.</div>
      </div>
      <div class="card">
        <h2>ğŸ“Š DaÄŸÄ±lÄ±m</h2>
        <div id="f_results"></div>
        <pre id="f_debug">Sistem hazÄ±r...</pre>
      </div>
    </div>
  </div>

  <div id="Diyet" class="tab-content">
  <div class="card" style="max-width:800px; margin:auto;">
    <h2>ğŸ©¸ Diyet (Kan Bedeli) Hesaplama</h2>
    
    <div class="gold-info" style="background: #e1f5fe; border-color: #03a9f4;">
      â„¹ï¸ FÄ±khi Ã¶lÃ§Ã¼: Tam diyet 4250 gr altÄ±ndÄ±r (100 Deve = 42,5 gr AltÄ±n x 100).
    </div>
    
    <div class="row">
      <div class="col">
        <label>1 Deve Bedeli (TL):</label> 
        <input type="number" id="d_deve" value="127500">
      </div>
      <div class="col">
        <label>Zarar/SuÃ§ TÃ¼rÃ¼:</label>
        <select id="d_tur">
          <option value="100">Tam Diyet (Ã–lÃ¼m veya Tek Organ KaybÄ±)</option>
          <option value="50">YarÄ±m Diyet (Ã‡ift Organdan Birinin KaybÄ±)</option>
          <option value="33.33">1/3 Diyet (Hayati Yaralanmalar)</option>
        </select>
      </div>
    </div>
    
    <button onclick="calcDiyet()">Hesapla</button>
    <div id="d_res" style="margin-top:15px; display:none;" class="heir"></div>
    <div style="margin-top: 25px; background: #fafafa; border: 1px solid #eee; padding: 20px; border-radius: 12px; font-size: 13.5px;">
      <h3 style="margin-top:0; color:var(--primary); font-size: 16px;">ğŸ” Diyet TÃ¼rleri Nedir?</h3>
      <ul style="padding-left: 20px;">
        <li><b>Tam Diyet (100 Deve):</b> Ã–lÃ¼m durumunda veya vÃ¼cutta tek olan organlarÄ±n (dil, burun) kaybÄ±nda Ã¶denir.</li>
        <li><b>YarÄ±m Diyet (50 Deve):</b> Ã‡ift organlardan sadece birinin (tek gÃ¶z, tek el, tek kulak) kaybÄ±nda Ã¶denir.</li>
        <li><b>1/3 Diyet (33,3 Deve):</b> Beyin zarÄ±na veya karÄ±n boÅŸluÄŸuna ulaÅŸan derin ve hayati yaralanmalarda Ã¶denir.</li>
      </ul>
           <div style="background: #fff; border: 1px dashed #ccc; padding: 12px; margin-top: 15px;">
        <p><b>ğŸ“– Ayet-i Kerime:</b> "...Kim bir mÃ¼mini yanlÄ±ÅŸlÄ±kla Ã¶ldÃ¼rÃ¼rse, mÃ¼min bir kÃ¶le azat etmesi ve Ã¶lenin ailesine teslim edilecek bir diyet Ã¶demesi gerekir..." (NisÃ¢, 92)</p>
        <hr style="border: 0; border-top: 1px solid #eee;">
        <p><b>ğŸ’¬ Hadis-i Åerif:</b> "Bir mÃ¼minin (hataen) Ã¶ldÃ¼rÃ¼lmesine karÅŸÄ±lÄ±k diyet 100 devedir. Beyin zarÄ±na ulaÅŸan aÄŸÄ±r yaralara (me'mume) Ã¼Ã§te bir diyet gerekir." (NesÃ¢Ã®, KasÃ¢me, 40)</p>
      </div>
    </div>
    <div class="official-warning">
      âš ï¸ DÄ°KKAT: Diyet miktarlarÄ± ve organlarÄ±n fonksiyonel kayÄ±p oranlarÄ± fÄ±khi ve tÄ±bbi uzmanlÄ±k gerektirir. GerÃ§ek bir uygulama iÃ§in mutlaka Ä°l MÃ¼ftÃ¼lÃ¼ÄŸÃ¼'ne danÄ±ÅŸÄ±lmalÄ±dÄ±r.
    </div>
  </div>
</div>

  <div id="Iddet" class="tab-content">
    <div class="card" style="max-width:800px; margin:auto;">
      <h2>â³ Ä°ddet SÃ¼resi</h2>
      <label>Durum:</label>
      <select id="i_durum">
        <option value="1">BoÅŸanma (Adet gÃ¶ren)</option>
        <option value="2">BoÅŸanma (Adetten kesilmiÅŸ)</option>
        <option value="3">EÅŸi Ã–len (Vefat)</option>
        <option value="4">Hamilelik</option>
      </select>
      <button onclick="calcIddet()">SÃ¼reyi GÃ¶ster</button>
      <div id="i_res" style="margin-top:15px; display:none;" class="heir"></div>
      <div class="verse-box"><b>ğŸ“– Ayet:</b> "BoÅŸanan kadÄ±nlar Ã¼Ã§ hayÄ±z sÃ¼resi beklerler..." (Bakara, 228)</div>
      <div class="official-warning">âš ï¸ EN DOÄRU BÄ°LGÄ° Ä°Ã‡Ä°N Ä°L MÃœFTÃœLÃœÄÃœNE BAÅVURUNUZ. BU KONUDA ÃœLKENÄ°N YÃœRÃœRLÃœKTE OLAN HUKUKÄ° MEVZUATLARI DA Ä°NCELENMELÄ°DÄ°R. HEM ÃœLKEDEKÄ° MEVZUAT HEM ÅERÄ° HUKUK BÄ°RLÄ°KTE ELE ALINIP Ä°KÄ°SÄ°NDEN HANGÄ°SÄ° DAHA Ä°LERÄ° TARÄ°HÄ° BELÄ°RTÄ°YORSA O TARÄ°HE DEK EVLENÄ°LMEMESÄ°, FARKLI BÄ°R KARÅI CÄ°NSLE HAYATIN BÄ°RLEÅTÄ°RÄ°LMEMESÄ° UYGUN OLACAKTIR.</div>
    </div>
  </div>
</div>

<script>
function openTab(evt, name) {
  let content = document.getElementsByClassName("tab-content");
  for (let i=0; i<content.length; i++) content[i].style.display = "none";
  let btns = document.getElementsByClassName("tab-btn");
  for (let i=0; i<btns.length; i++) btns[i].classList.remove("active");
  document.getElementById(name).style.display = "block";
  evt.currentTarget.classList.add("active");
}

async function fetchGoldPrice() {
  const goldText = document.getElementById('current_gold_text');
  const zFiyatInput = document.getElementById('z_fiyat');
  try {
    const response = await fetch('https://api.collectapi.com/economy/goldPrice', {
        headers: { "content-type": "application/json", "authorization": "apikey GUNCEL_KEYINIZ" }
    });
    const data = await response.json();
    if(data.success) {
        const price = data.result[0].buying;
        zFiyatInput.value = price;
        goldText.innerText = price + " TL";
    } else { throw new Error(); }
  } catch (e) {
    goldText.innerText = zFiyatInput.value + " TL (Manuel)";
  }
  updateDevePrice();
}

function updateDevePrice() {
  const gold = Number(document.getElementById('z_fiyat').value);
  document.getElementById('d_deve').value = Math.round(gold * 42.5);
}

function calcZekat() {
  let f=Number(document.getElementById('z_fiyat').value), 
      v=(Number(document.getElementById('z_altin').value)*f)+Number(document.getElementById('z_nakit').value)+Number(document.getElementById('z_ticari').value), 
      n=85*f, r=document.getElementById('z_res');
  r.style.display='block';
  r.innerHTML = v>=n ? `<b>Zekat Gerekir.</b> VarlÄ±k: ${v.toLocaleString()} TL <br>Zekat (%2.5): <b>${(v*0.025).toLocaleString()} TL</b>` : `Nisab altÄ±.`;
}

function calcDiyet() {
  let r=document.getElementById('d_res'); r.style.display='block';
  let total = document.getElementById('d_deve').value * document.getElementById('d_tur').value;
  r.innerHTML = `Hesaplanan Bedel: <b>${Math.round(total).toLocaleString()} TL</b>`;
}

function calcIddet() {
  let v=document.getElementById('i_durum').value, r=document.getElementById('i_res');
  r.style.display='block';
  let m = v=="1" ? "3 Temizlik DÃ¶nemi (YaklaÅŸÄ±k 3 Ay)" : (v=="2" ? "3 Ay" : (v=="3" ? "4 Ay 10 GÃ¼n" : "DoÄŸuma Kadar"));
  r.innerHTML = `Bekleme SÃ¼resi: <b>${m}</b>`;
}

function calcFeraiz() {
  const gender=document.getElementById('f_gender').value, spouses=parseInt(document.getElementById('f_spouses').value)||0,
        sons=parseInt(document.getElementById('f_sons').value)||0, daughters=parseInt(document.getElementById('f_daughters').value)||0,
        grsons=parseInt(document.getElementById('f_grsons').value)||0, grdau=parseInt(document.getElementById('f_grdau').value)||0,
        replace=document.getElementById('f_replace').checked, mother=document.getElementById('f_mother').value==='yes',
        father=document.getElementById('f_father').value==='yes', bro=parseInt(document.getElementById('f_bro').value)||0, 
        sis=parseInt(document.getElementById('f_sis').value)||0;
  
  let logs = [], fixed = {}, results = [];
  const hasChild = (sons+daughters)>0;
  const efSons = !hasChild && replace ? grsons : sons;
  const efDau = !hasChild && replace ? grdau : daughters;
  const childPresent = (efSons + efDau) > 0;

  if (spouses > 0) {
    let s = childPresent ? (gender==='male' ? 1/8 : 1/4) : (gender==='male' ? 1/4 : 1/2);
    fixed.spouse = { label: spouses+(gender==='male'?" KarÄ±":" Koca"), val: s, count: spouses };
  }
  if (mother) fixed.mother = { label:"Anne", val: (childPresent || (bro+sis)>1) ? 1/6 : 1/3, count:1 };
  if (father) fixed.father = { label:"Baba (Farz)", val: 1/6, count:1 };
  if (efSons === 0 && efDau > 0) fixed.dau = { label: efDau+" KÄ±z", val: efDau===1 ? 1/2 : 2/3, count: efDau };

  let sumFixed = 0;
  for(let k in fixed) sumFixed += fixed[k].val;
  if(sumFixed > 1) {
    logs.push("Avliyye (Awl) uygulandÄ±: Paylar 1'i aÅŸtÄ±ÄŸÄ± iÃ§in orantÄ±landÄ±.");
    for(let k in fixed) fixed[k].val /= sumFixed;
    sumFixed = 1;
  }

  for(let k in fixed) results.push({ label:fixed[k].label, frac:fixed[k].val, each:fixed[k].val/fixed[k].count, count:fixed[k].count });

  let remainder = Math.max(0, 1 - sumFixed);
  if(remainder > 0.001) {
    if(efSons > 0) {
      let u = (efSons*2)+efDau; let p=remainder/u;
      results.push({ label: efSons+" OÄŸul (Asaba)", frac:p*efSons*2, each:p*2, count:efSons });
      if(efDau>0) results.push({ label: efDau+" KÄ±z (Asaba)", frac:p*efDau, each:p, count:efDau });
    } else if(father) {
      results.push({ label: "Baba (Asaba)", frac:remainder, each:remainder, count:1 });
    } else if(bro+sis > 0) {
      let u = (bro*2)+sis; let p=remainder/u;
      if(bro>0) results.push({ label: bro+" Erkek KardeÅŸ", frac:p*bro*2, each:p*2, count:bro });
      if(sis>0) results.push({ label: sis+" KÄ±z KardeÅŸ", frac:p*sis, each:p, count:sis });
    } else {
      results.push({ label: "Reddiye / DiÄŸer", frac:remainder, each:remainder, count:1 });
    }
  }
  
  let out = document.getElementById('f_results'); out.innerHTML = "";
  results.forEach(r => {
    out.innerHTML += `<div class="heir"><div style="display:flex; justify-content:space-between;"><div><b>${r.label}</b><br><small>${r.count} KiÅŸi</small></div><div style="text-align:right"><div class="pct">${(r.frac*100).toFixed(2)}%</div><small>KiÅŸi baÅŸÄ±: ${(r.each*100).toFixed(2)}%</small></div></div></div>`;
  });
  document.getElementById('f_debug').innerText = logs.length ? logs.join("\n") : "PaylaÅŸÄ±m standart asaba ve sabit pay kurallarÄ±na gÃ¶re yapÄ±lmÄ±ÅŸtÄ±r.";
}
</script>
</body>
</html>
